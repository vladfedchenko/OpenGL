/*
 * ShaderProgram.cpp
 *
 *  Created on: Aug 21, 2016
 *      Author: vladfedchenko
 */

#include "../Headers/ShaderProgram.h"
#include "assert.h"
#include <string>
#include <fstream>
#include <exception>

namespace VladFedchenko{
namespace GL{

	ShaderProgram::ShaderProgram(GLuint program)
	{
		if (glIsProgram(program) != GL_TRUE)
		{
			throw std::exception();
		}
		this->program = program;
	}

	ShaderProgram::ShaderProgram(const ShaderInfo *shaders, int shaderCount)
	{
		for (int i = 0; i < shaderCount; ++i)
		{
			GLuint shader = glCreateShader(shaders[i].type);
			std::string src;
			this->ReadShader(shaders[i].filename, src);
			const char *srcRef = src.c_str();
			glShaderSource(shader, 1, &srcRef, 0);
			glCompileShader(shader);

			GLint sStatus;
			glGetShaderiv(shader, GL_COMPILE_STATUS, &sStatus);


		}
	}

	void ShaderProgram::ReadShader(const char* filename, std::string &s)
	{
		std::string line("");
		std::ifstream shaderFile(filename);
		if (shaderFile.is_open())
		{
			while(std::getline(shaderFile, line))
			{
				s += line + "\n";
			}
			shaderFile.close();
		}
	}

}}


